# Eternal bash history.
# ---------------------
# Undocumented feature which sets the size to "unlimited".
# http://stackoverflow.com/questions/9457233/unlimited-bash-history

export HISTSIZE=1000000
export HISTFILESIZE=1000000
export HISTFILE=~/.bash_eternal_history

# history options
setopt hist_ignore_all_dups

export PROMPT_COMMAND='LAST_COMMAND_EXIT=$? && history -a && test 127 -eq $LAST_COMMAND_EXIT && head -n -2 $HISTFILE >${HISTFILE}_temp && mv ${HISTFILE}_temp $HISTFILE'

# Source homeshick
source "$HOME/.homesick/repos/homeshick/homeshick.sh"

# Use code as default editor
export EDITOR="code -r"

# Auto determine shell extension
if [ -z $SHELL ]; then
    echo "${RED}SHELL not set${NC}"
    export SHELL=/bin/zsh
fi

export ext=$(basename ${SHELL});

# Source dotfiles
source "$HOME/.homesick/repos/dotfiles/home/system.sh"
source "$HOME/.homesick/repos/dotfiles/home/git.sh"

if (command -v docker &> /dev/null) ; 
then 
    source "$HOME/.homesick/repos/dotfiles/home/docker.sh"; 
fi

# if running in docker then source ros
[ $RUNNING_IN_DOCKER ] && source "$HOME/.homesick/repos/dotfiles/home/ros.sh"

# Source aliases
[ -f $HOME/.bash_aliases ] && source $HOME/.bash_aliases

# Source cargo for rust
[ -f $HOME/.cargo/env ] && source $HOME/.cargo/env

# Refresh homeshick
$HOME/.homesick/repos/homeshick/bin/homeshick --quiet refresh 2
